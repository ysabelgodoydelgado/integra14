<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="view_form_action_get_status_print" model="ir.ui.view">
            <field name="name">Campos y botones de maquina fiscal en factura</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_move_form"/>

                <field name="arch" type="xml">
                
                    <button name="button_draft" position="after">

                        <!--Invoice-->
                        <button name="print_invoice" string="Imprimir FAC en maquina" type="object"
                         attrs='{"invisible": ["|","|",("state", "in",["draft","cancel"]),"|",("serial_machine","!=",False),"&amp;",("amount_residual","!=",0),("is_credit","=",False),("move_type","!=","out_invoice")]}'/>
                        
                        
                        <button name="reprint_invoice" string="Reimprimir en maquina" type="object" 
                        attrs='{"invisible": ["|",("serial_machine","=",False),("move_type","not in",["out_invoice","out_refund"])]}'/>


                        <!--Credit note-->
                        <button name="print_credit_note" type="object" string="Imprimir NC en maquina" 
                            attrs='{"invisible": ["|","|",("state", "in",["draft","cancel"]),"|",("serial_machine","!=",False),"&amp;",("amount_residual","!=",0),("is_credit","=",False),("move_type","!=","out_refund")]}'/>
                    </button>
                    
                    <!--<button name="action_invoice_draft" position="after">
                        <button name="get_data_programed" string="Imprimir programacion" type="object"/>
                    </button>-->

                    <!--<button name="action_invoice_draft" position="after">
                        <button name="get_status" string="Obtener Estado" groups="base.group_system" type="object"/>
                    </button>-->
                    <!--remove tax domain in xml, will take in model -->

                    <button name="button_draft" position="after">
                        <button name="get_status_error" string="Consultar estado de la mÃ¡quina" type="object"/>
                    </button>
                    <xpath expr="//field[@name='invoice_line_ids']/tree/field[@name='tax_ids']" position="attributes">
                        <attribute name="domain"/>
                    </xpath>
                    <xpath expr="//div[@name='journal_div']" position="after">
                        <field name="serial_machine"  force_save="1" /><!--attrs="{'invisible': [('serial_machine', '=', False)]}" readonly="1"-->
                    </xpath>

                    <xpath expr="//div[@name='journal_div']" position="after">
                        <field name="is_credit" attrs="{'readonly': ['|',('state', 'not in',['draft']),('serial_machine','!=',False)], 'invisible':[('move_type','!=','out_invoice')]}"/>
                    </xpath>

                    <xpath expr="//div[@name='journal_div']" position="after">
                        <field name="machine_invoice_number"   force_save="1"/><!--attrs="{'invisible': [('serial_machine', '=', False)]}" readonly="1"-->
                    </xpath>

                    <xpath expr="//page[@name='other_info']" position="inside">
                        <field name="origin_country"  attrs="{'readonly': ['|',('state', 'not in',['draft']),('serial_machine','!=',False)], 'invisible':[('move_type','!=','out_refund'),('reversed_entry_id','!=',False)]}"/>
                        <field name="origin_date"  attrs="{'readonly': ['|',('state', 'not in',['draft']),('serial_machine','!=',False)], 'invisible':[('move_type','!=','out_refund'),('reversed_entry_id','!=',False)]}"/>
                        
                    </xpath>
                    

              

                </field>
        </record>


        <record id="view_invoice_list_machine" model="ir.ui.view">
            <field name="name">campos de maquina en lista de facturas</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_invoice_tree"/>

                <field name="arch" type="xml">
                    <xpath expr="//field[@name='invoice_origin']" position="after">
                        <field name="serial_machine" attrs="{'invisible': [('serial_machine', '=', False)]}" readonly="1" force_save="1" />
                    </xpath>

                    <!--<xpath expr="//field[@name='origin']" position="after">
                        <field name="is_credit" attrs="{'readonly': ['|',('state', 'not in',['draft','open']),('serial_machine','!=',False)]}"/>
                    </xpath>-->
                    

                </field>
        </record>
    </data>
</odoo>

